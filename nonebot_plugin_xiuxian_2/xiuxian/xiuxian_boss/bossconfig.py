try:
    import ujson as json
except ImportError:
    import json
import os
from pathlib import Path

configkey = ["Boss灵石", "Boss名字", "Boss倍率", "Boss个数上限", "Boss生成时间参数", 'open', "世界积分商品"]
CONFIG = {
    "open": {
        "000000": {}
            },
    "Boss灵石": {
        '感气境': [10000000, 15000000, 20000000],
        '练气境': [10000000, 15000000, 20000000],
        '筑基境': [10000000, 15000000, 20000000],
        '结丹境': [10000000, 15000000, 20000000],
        '金丹境': [10000000, 15000000, 20000000],
        '元神境': [10000000, 15000000, 20000000],
        '化神境': [20000000, 25000000, 30000000],
        '炼神境': [20000000, 25000000, 30000000],
        '返虚境': [20000000, 25000000, 30000000],
        '大乘境': [20000000, 25000000, 30000000],
        '虚道境': [20000000, 25000000, 30000000],
        '斩我境': [20000000, 25000000, 30000000],
        '遁一境': [30000000, 35000000, 40000000],
        '至尊境': [30000000, 35000000, 40000000],
        '微光境': [40000000, 45000000, 50000000],
        '星芒境': [40000000, 45000000, 50000000],
        '月华境': [45000000, 50000000, 55000000],
        '耀日境': [45000000, 50000000, 55000000],
        '祭道境': [50000000, 55000000, 60000000],
        '自在境': [50000000, 55000000, 60000000],
        '破虚境': [60000000, 65000000, 70000000],
        '无界境': [60000000, 65000000, 70000000],
        '混元境': [60000000, 65000000, 70000000],
        '造化境': [60000000, 65000000, 70000000],
        '永恒境': [60000000, 65000000, 70000000]
    },
    "Boss名字": [
        "九寒",
        "精卫",
        "少姜",
        "陵光",
        "莫女",
        "术方",
        "卫起",
        "血枫",
        "以向",
        "砂鲛",
        "鲲鹏",
        "天龙",
        "莉莉丝",
        "霍德尔",
        "历飞雨",
        "神风王",
        "衣以候",
        "金凰儿",
        "元磁道人",
        "外道贩卖鬼",
        "散发着威压的尸体"
        ],  # 生成的Boss名字，自行修改
    "讨伐世界Boss体力消耗": 10,
    "Boss倍率": {
        # Boss属性：大境界平均修为是基础数值，气血：2500倍，真元：10倍，攻击力：2倍
        # 作为参考：人物的属性，修为是基础数值，气血：0.5倍，真元：1倍，攻击力：0.1倍
        "气血": 2500,
        "真元": 10,
        "攻击": 2
    },
    "Boss生成时间参数": {  # Boss生成的时间，2个不可全为0
        "hours": 0,
        "minutes": 45
    },
    "世界积分商品": {
        "1": {
            "id": 1999,
            "cost": 1000,
            "desc": "渡厄丹,使下一次突破丢失的修为减少为0!"
        },
        "2": {
            "id": 4003,
            "cost": 5000,
            "desc": "陨铁炉,以陨铁炼制的丹炉,耐高温,具有基础的炼丹功能"
        },
        "3": {
            "id": 4002,
            "cost": 25000,
            "desc": "雕花紫铜炉,表面刻有精美雕花的紫铜丹炉,一看便出自大师之手,可以使产出的丹药增加1枚"
        },
        "4": {
            "id": 4001,
            "cost": 100000,
            "desc": "寒铁铸心炉,由万年寒铁打造的顶尖丹炉,可以使产出的丹药增加2枚"
        },
        "5": {
            "id": 2500,
            "cost": 5000,
            "desc": "一级聚灵旗,提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "6": {
            "id": 2501,
            "cost": 10000,
            "desc": "二级聚灵旗,提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "7": {
            "id": 2502,
            "cost": 20000,
            "desc": "三级聚灵旗,提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "8": {
            "id": 2503,
            "cost": 40000,
            "desc": "四级聚灵旗,提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "9": {
            "id": 2504,
            "cost": 80000,
            "desc": "仙级聚灵旗,大幅提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "10": {
            "id": 2505,
            "cost": 160000,
            "desc": "无上聚灵旗,极大提升洞天福地中的灵气汇集速度,加速修炼速度和灵田中药材生长速度"
        },
        "11": {
            "id": 7085,
            "cost": 2000000,
            "desc": "冲天槊，无上仙器，不属于这个位面的武器，似乎还有种种能力未被发掘...提升100%攻击力！提升50%会心率！提升20%减伤率！提升50%会心伤害！"
        },
        "12": {
            "id": 8931,
            "cost": 2000000,
            "desc": "苍寰变，无上神通，不属于这个位面的神通，连续攻击两次，造成6.5倍！7倍伤害！消耗气血0%、真元70%，发动概率100%，发动后休息一回合 "
        },
        "13": {
            "id": 9937,
            "cost": 2000000,
            "desc": "一气化三清，无上仙法，比上面几个还厉害，可惜太长写不下 "
        },
        "14": {
            "id": 10402,
            "cost": 700000,
            "desc": "真神威录，天阶下品辅修功法，增加70%会心率！"
        },
        "15": {
            "id": 10403,
            "cost": 1000000,
            "desc": "太乙剑诀，天阶下品辅修功法，增加100%会心伤害！"
        },
        "16": {
            "id": 10411,
            "cost": 1200000,
            "desc": "真龙九变，天阶上品辅修功法，增加攻击力60%！"
        },
        "17": {
            "id": 20004,
            "cost": 10000,
            "desc": "蕴灵石，蕴藏充足灵性，似有灵韵波动，神秘而独特。"
        },
        "18": {
            "id": 20003,
            "cost": 50000,
            "desc": "神圣石，神圣灵魂实体，散发庄严气息，蕴含神圣奥秘。"
        },
        "19": {
            "id": 20002,
            "cost": 200000,
            "desc": "化道石，无上强者化道遗留，承载其修行感悟，神秘非凡。"
        },
        "20": {
            "id": 20005,
            "cost": 1000,
            "desc": "祈愿石，蕴含神秘祈愿之力！它似命运水晶球，能感知你内心渴望。依靠它，能带来好运奇迹，助祈愿成真！"
        },
        "21": {
            "id": 15357,
            "cost": 100000,
            "desc": "八九玄功：无上仙法!"
        },
        "22": {
            "id": 9935,
            "cost": 100000,
            "desc": "暗渊灭世功：无上仙法!"
        },
        "23": {
            "id": 9940,
            "cost": 100000,
            "desc": "化功大法：无上仙法!"
        },
        "24": {
            "id": 10405,
            "cost": 50000,
            "desc": "醉仙：获得10%穿甲!"
        },
        "25": {
            "id": 10410,
            "cost": 1000000,
            "desc": "劫破：获得20%穿甲!"
        },
        "26": {
            "id": 10412,
            "cost": 2000000,
            "desc": "无极·靖天：获得35%穿甲!"
        },
        "27": {
            "id": 8033,
            "cost": 2000000,
            "desc": "冥河鬼镰·千慄葬世：冥河之水化作鬼镰，千慄葬世，收割万物生机！鬼镰划破天际，冥气弥漫，敌人灵魂被生生撕裂，坠入无尽深渊！此乃鬼噬之终章，天地同寂！"
        },
        "28": {
            "id": 8034,
            "cost": 2000000,
            "desc": "血影碎空·胧剑劫：血影碎空，胧剑出鞘，剑气化血雾，弥漫战场！敌人陷入血胧之中，剑气纵横，劫难降临，万物皆灭！"
        },
        "29": {
            "id": 8035,
            "cost": 2000000,
            "desc": "剑御九天·万剑归墟：剑御九天，万剑归墟，剑气化九天，剑网笼罩天地！敌人被剑气撕裂，万物归于虚无，此乃剑道极致！"
        },
        "30": {
            "id": 8036,
            "cost": 2000000,
            "desc": "华光·万影噬空：刹诀！华光·万影噬空！华光化万影，噬空夺命！敌人被无尽的光影吞噬，灵魂化为灰烬，天地皆为空影，唯我独尊！"
        }
    }
}


CONFIGJSONPATH = Path(__file__).parent
FILEPATH = CONFIGJSONPATH / 'config.json'

def get_boss_config():
    """加载配置，失败时返回默认配置但不覆盖文件"""
    if not os.path.exists(FILEPATH):
        # 如果文件不存在，保存默认配置
        savef_boss(CONFIG)
        return CONFIG
    config = readf()
    # 确保所有键存在
    for key in configkey:
        if key not in config:
            config[key] = CONFIG[key]
    return config

def readf():
    """读取配置文件"""
    try:
        with open(FILEPATH, "r", encoding="UTF-8") as f:
            return json.load(f)
    except Exception as e:
        print(f"警告: 读取 {FILEPATH} 失败: {e}")
        return CONFIG

def savef_boss(data):
    """保存配置"""
    try:
        # 确保目录存在
        os.makedirs(CONFIGJSONPATH, exist_ok=True)
        with open(FILEPATH, "w", encoding="UTF-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=3)
        return True
    except Exception as e:
        print(f"错误: 保存 {FILEPATH} 失败: {e}")
        return False